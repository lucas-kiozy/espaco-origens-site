<!DOCTYPE html><html lang="pt-br"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>entrar - espaço origens</title><meta name="description" content="acesse sua conta em espaço origens para acompanhar pedidos e ver favoritos."><meta name="theme-color" content="#B75E3C"><!-- favicon com base correta --><link rel="icon" href="/espaco-origens-sitefavicon.ico"><link rel="stylesheet" href="/espaco-origens-site/_astro/contato.BXL3963S.css"></head> <body class="min-h-dvh bg-creme text-marrom antialiased">  <header class="sticky top-0 z-50 border-b border-areia/70 bg-creme/80 backdrop-blur"> <nav class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between"> <!-- logo + wordmark --> <a href="/espaco-origens-site/" class="flex items-center gap-2"> <img src="/espaco-origens-site/images/logo.png" alt="Espaço Origens" class="h-9 w-9 rounded-full" width="38" height="38"> <span class="lowercase font-medium tracking-wide text-marrom">espaço origens</span> </a> <!-- menu desktop --> <div class="hidden md:flex items-center gap-1"> <a href="/espaco-origens-site/" class="navlink px-3 py-2 rounded-xl transition-colors lowercase navlink-idle "> início </a> <a href="/espaco-origens-site/sobre" class="navlink px-3 py-2 rounded-xl transition-colors lowercase navlink-idle "> sobre </a> <a href="/espaco-origens-site/contato" class="navlink px-3 py-2 rounded-xl transition-colors lowercase navlink-idle "> contato </a> </div> <!-- auth (desktop) --> <div class="hidden md:flex items-center"> <div id="loginDesk"> <a href="/espaco-origens-site/login" class="btn inline-flex items-center justify-center rounded-2xl font-medium lowercase transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-terracota/60 disabled:opacity-50 disabled:pointer-events-none px-3 py-2 text-sm !text-white bg-terracota hover:brightness-110 active:translate-y-[1px] ">entrar</a> </div> <div id="logoutDesk" class="hidden"> <button class="btn inline-flex items-center justify-center rounded-2xl font-medium lowercase transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-terracota/60 disabled:opacity-50 disabled:pointer-events-none px-3 py-2 text-sm border border-terracota text-terracota bg-creme hover:bg-areia/50 active:translate-y-[1px] " id="logoutBtnDesk">sair</button> </div> </div> <!-- hambúrguer --> <button id="menuBtn" type="button" class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-xl text-marrom ring-1 ring-terracota/50 bg-creme/90 hover:bg-areia/60 relative z-[60] pointer-events-auto touch-manipulation" aria-label="abrir menu" aria-controls="mobileNav" aria-expanded="false"> <svg viewBox="0 0 24 24" class="h-6 w-6" aria-hidden="true"> <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"></path> </svg> </button> </nav> <!-- menu mobile --> <div id="mobileNav" class="md:hidden hidden border-t border-areia/70 bg-creme" aria-hidden="true"> <div class="max-w-6xl mx-auto px-4 py-3 flex flex-col gap-2"> <a href="/espaco-origens-site/" class="navlink px-3 py-2 rounded-xl transition-colors lowercase navlink-idle "> início </a> <a href="/espaco-origens-site/sobre" class="navlink px-3 py-2 rounded-xl transition-colors lowercase navlink-idle "> sobre </a> <a href="/espaco-origens-site/contato" class="navlink px-3 py-2 rounded-xl transition-colors lowercase navlink-idle "> contato </a> <div id="loginMob"> <a href="/espaco-origens-site/login" class="btn inline-flex items-center justify-center rounded-2xl font-medium lowercase transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-terracota/60 disabled:opacity-50 disabled:pointer-events-none px-5 py-3 text-base !text-white bg-terracota hover:brightness-110 active:translate-y-[1px] mt-1">entrar</a> </div> <div id="logoutMob" class="hidden"> <button class="btn inline-flex items-center justify-center rounded-2xl font-medium lowercase transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-terracota/60 disabled:opacity-50 disabled:pointer-events-none px-5 py-3 text-base border border-terracota text-terracota bg-creme hover:bg-areia/50 active:translate-y-[1px] mt-1" id="logoutBtnMob">sair</button> </div> </div> </div> <script>
    const btn = document.getElementById('menuBtn');
    const nav = document.getElementById('mobileNav');

    let isOpen = false;
    let suppressNextDocClick = false;

    function setOpen(v) {
      isOpen = v;
      if (!nav || !btn) return;
      nav.classList.toggle('hidden', !v);
      btn.setAttribute('aria-expanded', String(v));
      nav.setAttribute('aria-hidden', String(!v));
    }
    function toggle() { setOpen(!isOpen); }

    // abre/fecha pelo botão
    const onBtnActivate = (e) => {
      e.preventDefault();
      suppressNextDocClick = true; // ignora o clique que borbulha para document
      toggle();
    };
    btn?.addEventListener('click', onBtnActivate);
    btn?.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); onBtnActivate(e); }
    });

    // clique fora fecha (ignorando o evento que veio do próprio botão)
    document.addEventListener('click', (e) => {
      if (!isOpen) return;
      if (suppressNextDocClick) { suppressNextDocClick = false; return; }
      const t = e.target;
      if (!(t instanceof Element)) return;
      if (!nav.contains(t) && !btn.contains(t)) setOpen(false);
    });

    // clicar em link do menu fecha
    nav?.addEventListener('click', (e) => {
      const t = e.target;
      if (t instanceof Element && t.closest('a')) setOpen(false);
    });

    // fecha ao mudar para desktop
    const mq = window.matchMedia('(min-width: 768px)');
    (mq.addEventListener
      ? mq.addEventListener('change', (ev) => ev.matches && setOpen(false))
      : (mq.onchange = (ev) => ev.matches && setOpen(false)));

    // ---- login/logout com Supabase ----
    let currentUser = null;

    async function checkAuth() {
      try {
        const { getCurrentUser } = await import('../lib/auth.ts');
        currentUser = await getCurrentUser();
        syncAuthUI();
      } catch (error) {
        console.error('Error checking auth:', error);
        currentUser = null;
        syncAuthUI();
      }
    }

    function syncAuthUI() {
      const loginDesk = document.getElementById('loginDesk');
      const logoutDesk = document.getElementById('logoutDesk');
      const loginMob  = document.getElementById('loginMob');
      const logoutMob = document.getElementById('logoutMob');
      const logged = !!currentUser;
      
      loginDesk?.classList.toggle('hidden', logged);
      logoutDesk?.classList.toggle('hidden', !logged);
      loginMob?.classList.toggle('hidden', logged);
      logoutMob?.classList.toggle('hidden', !logged);
    }

    // base a partir da <base href="..."> (evita usar import.meta no browser)
    function getBaseHref() {
      const href = document.querySelector('base')?.getAttribute('href') || '/';
      return href.replace(/\/+$/, '');
    }

    async function doLogout() {
      try {
        const { signOut } = await import('../lib/auth.ts');
        await signOut();
        currentUser = null;
        syncAuthUI();
        const home = getBaseHref();
        if (!location.pathname.startsWith(home)) location.href = home + '/';
        setOpen(false);
      } catch (error) {
        console.error('Error signing out:', error);
      }
    }

    document.getElementById('logoutBtnDesk')?.addEventListener('click', doLogout);
    document.getElementById('logoutBtnMob')?.addEventListener('click', doLogout);

    // Verificar autenticação ao carregar
    document.addEventListener('DOMContentLoaded', checkAuth);

    // Escutar mudanças de autenticação
    import('../lib/auth.ts').then(({ onAuthStateChange }) => {
      onAuthStateChange((user) => {
        currentUser = user;
        syncAuthUI();
      });
    });

    // Forçar rechecagem se acabou de logar
    if (localStorage.getItem('justLoggedIn')) {
      localStorage.removeItem('justLoggedIn');
      setTimeout(checkAuth, 200); // força rechecagem após 200ms
    }
  </script> </header> <main class="flex items-center justify-center min-h-[calc(85vh-8rem)] px-4 py-12"> <section class="w-full max-w-md bg-areia/40 border border-areia/70 rounded-2xl shadow-sm p-6"> <h1 class="text-2xl lowercase text-marrom mb-2">entrar</h1> <p class="text-marrom/80 mb-4 text-sm">
use seu email e senha. quando a loja estiver ativa, você poderá acompanhar pedidos e favoritos.
</p> <!-- formulário de login --> <form id="loginForm" novalidate> <!-- campo email --> <div> <label for="email">email</label> <input id="email" name="email" type="email" required placeholder="nome@exemplo.com" autocomplete="email"> </div> <!-- campo senha --> <div> <label for="password">senha</label> <input id="password" name="password" type="password" required minlength="6" placeholder="sua senha" autocomplete="current-password"> </div> <!-- botão e link --> <button class="btn inline-flex items-center justify-center rounded-2xl font-medium lowercase transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-terracota/60 disabled:opacity-50 disabled:pointer-events-none px-5 py-3 text-base !text-white bg-terracota hover:brightness-110 active:translate-y-[1px] btn-primary" type="submit">entrar</button> <a href="?signup=true" class="recover-link">criar conta</a> <a href="#" class="recover-link">recuperar conta</a> <!-- feedback --> <p id="feedback" class="text-sm mt-2 text-cinza" aria-live="polite"></p> </form> </section> </main> <footer class="mt-16 border-t border-areia/70"> <div class="max-w-6xl mx-auto px-4 py-8 text-sm text-cinza"> <div class="flex flex-col sm:flex-row items-center justify-between gap-3"> <p>© 2025 espaço origens</p> <div class="flex gap-4"> <a href="https://instagram.com/espaco_origens" target="_blank" rel="noopener" class="hover:text-marrom">instagram</a> <a href="https://wa.me/5521981869391" target="_blank" rel="noopener" class="hover:text-marrom">whatsapp</a> </div> </div> </div> </footer>  <script type="module" src="/espaco-origens-site/_astro/login.astro_astro_type_script_index_0_lang.B0h93ZNJ.js"></script>  </body></html>